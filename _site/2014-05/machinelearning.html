
<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8">
    <title>监督学习:线性回归 - shengxc's blog</title>
    <meta name="description" content="斯坦福大学机器学习公开课笔记">
    <meta name="keywords" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->

    <link href="http://cdn.bootcss.com/twitter-bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet" media="all">
    <link href="http://cdn.bootcss.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet" media="all">
    <link href="/assets/themes/havee/css/style.css?body=1" rel="stylesheet" media="all">
    <link href="/assets/themes/havee/css/pygments.css" rel="stylesheet" media="all">
    <link href="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" media="all">
    <link href="/assets/themes/havee/css/" rel="stylesheet" media="all">

    <link rel="shortcut icon" href="/favicon.png">
    <link rel="canonical" href="/2014-05/machinelearning.html">
    <!-- fav and touch icons -->
    <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.png">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="shengxc's blog ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="shengxc's blog RSS Feed">

  </head>

  <body>
    <!--[if lte IE 9]>
    <div class="alert alert-warning">
      <p>Your Internet Explorer is not supported. Please upgrade your Internet Explorer to version 9+, or use latest <a href="http://www.google.com/chrome/" target="_blank" class="alert-link">Google chrome</a>、<a href="http://www.mozilla.org/firefox/" target="_blank" class="alert-link">Mozilla Firefox</a>.</p>
      <p>If you are using IE 9 or later, make sure you <a href="http://windows.microsoft.com/en-us/internet-explorer/use-compatibility-view#ie=ie-8" target="_blank" class="alert-link">turn off "Compatibility view"</a>.</p>
    </div>
    <![endif]-->

    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/" title="shengxc's blog">shengxc's blog</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse navbar-ex1-collapse">
        <ul class="nav navbar-nav">
          
          
          


  
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
  




          <li>
          <form id="search-form" class="form-inline visible-lg" role="form">
            <input type="text" class="form-control input-sm" placeholder="Search" id="query">
          </form>
          </li>
        </ul>

        <ul class="nav navbar-nav navbar-right visible-lg visible-md">
          <li><a href="/rss.xml" target="_blank" title="RSS"><span class="fa fa-rss fa-lg"></span></a></li>
          
          
          
          
          
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
    </nav>

    <div class="container">
      <div class="content">
        
<div class="row">

  <article class="col-md-9 main-contenter">
    <div id="search-loader" style="display:none;text-align:center">
      <img src="/assets/themes/havee/images/loading.gif">
    </div>
    <div class="page-header">
      <h2>
        监督学习:线性回归
        
      </h2>
	  <div class="bottom">
		<span class="glyphicon glyphicon-user"></span><p></p>
	    <span class="glyphicon glyphicon-calendar"></span><p>21 May 2014</p>
		<span class="glyphicon glyphicon-folder-open"></span> 
		<span class="glyphicon glyphicon-tags"></span> <a href="/tags.html#机器学习-ref" title="机器学习"><p>机器学习</p></a>
      </div>
    </div>
    <div class="wrapper"><h1 id="linear-regression">线性回归（Linear Regression）</h1>

<h2 id="section">符号说明</h2>
<ul>
  <li>$X^{(i)}$:features</li>
  <li>$y^{(i)}$:target</li>
  <li>$(X^{(i)},y^{(i)})$:$i^{th}$training example</li>
  <li>$m$:the number of training examples</li>
  <li>$n$:the size of feature</li>
  <li>$\Theta$：parameter vector</li>
</ul>

<h2 id="section-1">回归模型</h2>
<blockquote>
  <p>线性回归模型为<script type="math/tex">h_{\Theta}(x)=\Theta_0+\sum_{i=1}^{n}\Theta_ix_i</script>
令$x_0=1$,则特征向量$X=[x_0,x_1,…,x_n]^T$,模型可表示为
<script type="math/tex">h_{\Theta}(x)=\Theta_0+\sum_{i=1}^{n}\Theta_ix_i=\Theta^TX</script>
机器学习算法的目的是学出上述$\Theta$向量，这样，便可对任意输入$X$向量得到上述$h_{\Theta}(x)$作为预测输出。</p>
</blockquote>

<h2 id="section-2">目标函数</h2>
<blockquote>
  <p>cost function为<script type="math/tex">J(\Theta)=\frac{1}{2}\sum_{i=1}^m(h_{\Theta}(X^{(i)})-y^{(i)})^2</script>由此，机器学习算法的目标可描述如下 <script type="math/tex">\min_{\Theta}J(\Theta)</script></p>
</blockquote>

<h1 id="section-3">解法</h1>

<h2 id="section-4">梯度下降</h2>

<h3 id="batch-gradient-descent">批量梯度下降(Batch gradient descent)</h3>

<p><strong>基本思想</strong></p>

<blockquote>
  <p>从某一特定$\Theta$开始，不断改变$\Theta$的取值来降低$J(\Theta)$直到收敛。此算法会收敛到local minimum，不同的初始$\Theta$也有可能收敛到不通的local minimum。（如果是线性回归，$J(\theta)$只有一个最小值）</p>
</blockquote>

<p><strong>算法流程</strong></p>

<blockquote>
  <ol>
    <li>任意给定一个初始$\Theta$值</li>
    <li>对于$\Theta$中所有分量，更新$\Theta_i := \Theta_i-\alpha\frac{\partial}{\partial\Theta_i}J(\Theta)$(此步即梯度下降，$\alpha$是步长)</li>
    <li>当cost function的变化小于某个给定阈值的时候算法停止</li>
  </ol>
</blockquote>

<p><strong>公式推导</strong></p>

<blockquote>
  <p><script type="math/tex">\frac{\partial}{\partial\Theta_i}J(\Theta)=\frac{\partial}{\partial\Theta_i}\frac{1}{2}\sum_{i=1}^m(h_{\Theta}(X^{(i)})-y^{(i)})^2=\sum_{j=1}^m(h_{\Theta}(X^{(j)})-y^{(j)})X^{(j)}_i</script>
将此公式带入算法流程中的第二步既得完整的算法。</p>
</blockquote>

<h3 id="stochastic-gradient-descent">随机梯度下降(Stochastic gradient descent)</h3>

<blockquote>
  <p>在批量梯度下降算法中，每次迭代都要遍历所有训练样本，当训练样本很多(m很大)时，算法的运行效率会变得很低。随机梯度下降算法会有比批量梯度下降算法快的多的下降速度。</p>
</blockquote>

<p><strong>算法流程</strong></p>

<blockquote>
  <ol>
    <li>任意给定一个初始$\Theta$值</li>
    <li>更新$\Theta_i$</li>
    <li>当cost function的变化小于某个给定阈值的时候算法停止</li>
  </ol>
</blockquote>

<p><strong>说明</strong></p>

<blockquote>
  <p>随机梯度下降算法跟批量梯度下降算法之间的不同之处在于第2步更新$\Theta$的方法。再随机梯度下降算法中，更新$\Theta$的方法是遍历每一个训练样本$(X^{(j)},y^{(j)})$按照以下公式更新$\Theta$所有的分量。
<script type="math/tex">\Theta_i:=\Theta_i-\alpha(h_{\Theta}(X^{(j)})-y^{(j)})X^{(j)}_i\ (for\ i = 0\ to\ n)</script>
随机梯度下降是通过每个样本来迭代更新一次，如果样本量很大，那么可能只用其中一部分样本，就已经将$\Theta$迭代到最优解了，对比上面的批量梯度下降，迭代一次需要用到所有训练样本，随机梯度下降算法快的多。但是，该算法并不是每次迭代都向着整体最优化方向下降。</p>
</blockquote>

<h3 id="section-5">矩阵方法</h3>
<p><strong>符号定义</strong></p>

<ul>
  <li>$\bigtriangledown_{\Theta}J=\begin{bmatrix}\frac{\partial{J}}{\partial\Theta_0} \\ … \\ \frac{\partial{J}}{\partial\Theta_n}\end{bmatrix} \in R^{n+1}$
  由上述符号，随机梯度下降算法迭代公式可表示为$\Theta=\Theta-\alpha\bigtriangledown_{\Theta}J\ \ (\Theta\in R^{n+1})$</li>
  <li>$f:R^{m\times n}\to R$</li>
  <li>$A \in R^{m\times n}$</li>
  <li>$\bigtriangledown_{A}f(A)=\begin{bmatrix}\frac{\partial{f}}{\partial A_{11}}&amp;…&amp; \frac{\partial{f}}{\partial A_{1n}}\\ …&amp;…&amp;… \\ \frac{\partial{f}}{\partial A_{m1}}&amp;…&amp;\frac{\partial{f}}{\partial A_{mn}}\end{bmatrix}$</li>
  <li>$X \in R^{n\times n}$</li>
  <li>$trX=\sum_{i=1}^{n}X_{ii}$ ($trX$表示矩阵$X$的迹)</li>
</ul>

<p><strong>不加证明的一些定理</strong></p>

<ul>
  <li>$trAB=trBA$</li>
  <li>$trABC=trCAB=trBCA$</li>
  <li>$\bigtriangledown_{A}trAB=B^T$</li>
  <li>$trA=trA^T$</li>
  <li>$tra=a\ (a\in R)$</li>
  <li>$\bigtriangledown_{A}trABA^TC=CAB+C^TAB^T$</li>
</ul>

<p><strong>梯度下降的推导</strong></p>

<p>定义矩阵<script type="math/tex">X=\begin{bmatrix}(X^{(1)})^T\\\\...\\\\(X^{(m)})^T\end{bmatrix}</script>
根据训练样本构造向量
<script type="math/tex">X\Theta=\begin{bmatrix}(X^{(1)})^T\\\\...\\\\(X^{(m)})^T\end{bmatrix}\Theta=\begin{bmatrix}(X^{(1)})^T\Theta\\\\...\\\\(X^{(m)})^T\Theta\end{bmatrix}=\begin{bmatrix}h_\Theta(X^{(1)})\\\\...\\\\h_\Theta(X^{(m)})\end{bmatrix}</script>
<script type="math/tex">Y=\begin{bmatrix}y^{(1)}\\\\...\\\\y^{(m)}\end{bmatrix}</script>
将上述两个向量相减，得</p>

<script type="math/tex; mode=display">X\Theta-Y=\begin{bmatrix}h_\Theta(X^{(1)})-y^{(1)}\\\\...\\\\h_\Theta(X^{(m)})-y^{(m)}\end{bmatrix}</script>

<script type="math/tex; mode=display">(X\Theta-Y)^T(X\Theta-Y)=\sum_{i=1}^m(h_\Theta(X^{(i)})-y^{(i)})^2=2J(\Theta)</script>

<script type="math/tex; mode=display">\Rightarrow J(\Theta)=\frac{1}{2}(X\Theta-Y)^T(X\Theta-Y)</script>

<p>要使$J(\Theta)$取得最小值，则需要满足$J(\Theta)$对$\Theta$的导数等于0向量，即
<script type="math/tex">\bigtriangledown_{\Theta}J(\Theta)=\vec{0}</script>
由$J(\Theta)$的计算公式可知</p>

<script type="math/tex; mode=display">J(\Theta)=\frac{1}{2}(X\Theta-Y)^T(X\Theta-Y)=\frac{1}{2}(\Theta^TX^T-Y^T)(X\Theta-Y)=\frac{1}{2}(\Theta^TX^TX\Theta-\Theta^TX^TY-Y^TX\Theta+Y^TY)</script>

<p>$J(\Theta)$是一个实数，所以</p>

<script type="math/tex; mode=display">\bigtriangledown_{\Theta}J(\Theta)=\bigtriangledown_{\Theta}trJ(\Theta)=\frac{1}{2}(\bigtriangledown_{\Theta}tr\Theta^TX^TX\Theta-\bigtriangledown_{\Theta}tr\Theta^TX^TY-\bigtriangledown_{\Theta}trY^TX\Theta+\bigtriangledown_{\Theta}trY^TY)</script>

<p>逐项分析：
第一项</p>

<script type="math/tex; mode=display">\bigtriangledown_{\Theta}tr\Theta^TX^TX\Theta=\bigtriangledown_{\Theta}tr\Theta\Theta^TX^TX=\bigtriangledown_{\Theta}tr\Theta I\Theta^TX^TX=X^TX\Theta+X^TX\Theta</script>

<p>上述推导最后一步把$\Theta$看作$A$，$I$看作$B$,$X^TX$看作$C$,应用上一小结中最后一条定理，$I$为单位矩阵
第二项
由于\Theta^TX^TY是一个实数，所以</p>

<script type="math/tex; mode=display">\bigtriangledown_{\Theta}tr\Theta^TX^TY=\bigtriangledown_{\Theta}trY^TX\Theta=(Y^TX)T=X^TY</script>

<p>上述推导中倒数第二步是把$Y^TX$看作$B$，$\Theta$看作$A$，利用上一小节中的定理三得到的。
第三项与第二项相同，第四项与$\Theta$无关，因此求导后为0,可以忽略。
最终可得</p>

<script type="math/tex; mode=display">\bigtriangledown_{\Theta}J(\Theta)=\frac{1}{2}(X^TX\Theta+X^TX\Theta-X^TY-X^TY)=0</script>

<script type="math/tex; mode=display">\Rightarrow X^TX\Theta=X^TY</script>

<script type="math/tex; mode=display">\Rightarrow \Theta=(X^TX)^{-1}X^TY</script>

<p><strong>Tips</strong></p>

<p>如果$X^TX$不可逆，可以用伪逆的方式计算，但一般情况下这种情况是因为特征选取的时候有依赖造成的。</p>

</div>
    <div class="cc">
      <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">
        <img title="署名-非商业性使用-相同方式共享 4.0 国际" src="/assets/images/CC.png" alt="License"></img>
      </a>
    </div>
    <div class="row status">
      <div class="col-md-6">
        <div class="btn-group">
          
          <a class="btn btn-primary btn-sm" href="/2014-05/python0.html" title="python的闭包和修饰器">&laquo; Prev</a>
          
          <a class="btn btn-primary btn-sm" href="/archive.html">Archive</a>
          
          <a class="btn btn-primary btn-sm" href="/2014-05/read_notes.html" title="数学中的数系">Next &raquo;</a>
          
        </div>
      </div>
      <div class="col-md-6 visible-lg visible-md">
      

      </div>
    </div>
    
<div id="comments">
  <div class="ds-thread" data-thread-key="/2014-05/machinelearning"  data-title="监督学习:线性回归 - shengxc's blog"></div>
</div>


  </article>

  <aside class="col-md-3 visible-lg visible-md">
          <!--      <section>
        <h4>Categories</h4>
        <div class="tag_box">
          <ul>
          
          


  
    
  

 
          </ul>
        </div>
      </section>
-->

            <section>
        <h4>Recently Posts</h4>
        <ul>
        
          <li><a href="/2014-06/machinelearning.html">局部加权回归和logistic回归</a></li>
        
          <li><a href="/2014-05/read_notes.html">数学中的数系</a></li>
        
          <li><a href="/2014-05/machinelearning.html">监督学习:线性回归</a></li>
        
          <li><a href="/2014-05/python0.html">python的闭包和修饰器</a></li>
        
          <li><a href="/2014-05/read_notes.html">自然数和数论</a></li>
        
          <li><a href="/2014-05/interview_record.html">零星的面试记忆</a></li>
        
          <li><a href="/2014-05/hello.html">第一篇博客</a></li>
        
        </ul>
      </section>


            
      <section>
        <h4>Recently Comments</h4>
          <ul class="ds-recent-comments" data-num-items="10" data-show-avatars="0" data-show-time="0" data-show-title="0" data-show-admin="0" data-excerpt-length="12"></ul>
      </section>
      


            
      <section>
        <h4>Recently Visitors</h4>
          <ul class="ds-recent-visitors" data-num-items="12" data-avatar-size="45"></ul>
      </section>
      


      <!--      
-->

  </aside>

</div>


      </div>

      <footer class="text-left">
      <p>&copy; 2014 <a href="/" target="_blank"></a>. with Help from <a href="http://jekyllbootstrap.com/" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a> and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a></p>
      </footer>
    </div> <!-- /container -->

    <script src="http://cdn.bootcss.com/jquery/2.1.0/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js"></script>

    <!--BEGIN添加代码美化-->
    <link href="/assets/google-code-prettify/prettify.css" rel="stylesheet" type="text/css" media="all">
    <script type="text/javascript" src="/assets/google-code-prettify/prettify.js"></script>
    <script type="text/javascript">
      $(function(){
      $("pre").addClass("prettyprint linenums");
      prettyPrint();
      });
    </script>
    <!--END添加代码美化-->

    <!--BEGIN 添加MathJax库支持公式显示-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!--END 添加MathJax库支持公式显示-->
    

    


  <!-- duoshuo Begin -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"shengxc"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = 'http://static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- duoshuo End -->





    

    

  </body>
</html>

